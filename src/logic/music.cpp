#include "music.h"

#include "config.h"
#include "musicPlayer.h"
#include "pixels.h"

#include <array>
#include <cmath>
#include <ctime>
#include <cctype>
#include <cstring>
#include <memory>

namespace {
  using Song = std::vector<const char*>;
  Song inTheHallOfTheMountainKing = {
    "X:0|35:213994|X:3396|37:106997|X:110393|38:213994|X:3396|40:106997|X:110393|42:213994|X:3396|38:106997|X:110393|42:213994|X:220787|41:213994|X:3396|37:106997|X:110393|41:213994|X:220787|40:213994|X:3396|36:106997|X:110393|40:213994|X:220787|35:213994|X:3396|37:106997|X:110393|38:213994|X:3396|40:106997|X:110393|42:213994|X:3396|38:106997|X:110393|42:213994|X:3396|47:106997|X:110393|45:213994|X:3396|42:106997|X:110393|38:213994|X:3396|42:106997|X:110393|45:784644|X:84918|47:213994|X:3396|49:106997|X:110393|50:213994|X:3396|52:106997|X:110393|54:213994|X:3396|50:106997|X:110393|54:213994|X:220787|53:213994|X:3396|49:106997|X:110393|53:213994|X:220787|52:213994|X:3396|48:106997|X:110393|52:213994|X:220787|47:213994|X:3396|49:106997|X:110393|50:213994|X:3396|52:106997|X:110393|54:213994|X:3396|50:106997|X:110393|54:213994|X:3396|59:106997|X:110393|57:213994|X:3396|54:106997|X:110393|50:213994|X:3396|54:106997|X:110393|45:784644|X:84918|42:213994|X:3396|44:106997|X:110393|46:213994|X:3396|47:106997|X:110393|49:213994|X:3396|46:106997|X:110393|49:213994|X:220787|50:213994|X:3396|46:106997|X:110393|50:213994|X:220787|49:213994|X:3396|46:106997|X:110393|49:213994|X:220787|42:213994|X:3396|44:106997|X:110393|46:213994|X:3396|47:106997|X:110393|49:213994|X:3396|46:106997|X:110393|49:213994|X:220787|50:213994|X:3396|46:106997|X:110393|50:213994|X:220787|49:426289|X:8491|37:213994|X:220787|54:213994|X:3396|56:106997|X:110393|58:213994|X:3396|59:106997|X:110393|61:213994|X:3396|58:106997|X:110393|61:213994|X:220787|62:213994|X:3396|58:106997|X:110393|62:213994|X:220787|61:213994|X:3396|58:106997|X:110393|61:213994|X:220787|54:213994|X:3396|56:106997|X:110393|58:213994|X:3396|59:106997|X:110393|61:213994|X:3396|58:106997|X:110393|61:213994|X:220787|62:213994|X:3396|58:106997|X:110393|62:213994|X:220787|61:426289|X:8491|37:213994|X:220787|35:210980|X:3301|37:103983|X:107284|38:207966|X:3301|40:103983|X:107284|42:207966|X:3301|38:103983|X:107284|42:207966|X:214568|41:207966|X:3301|37:103983|X:107284|41:207966|X:214568|40:207966|X:3301|36:103983|X:107284|40:207966|X:214568|35:207966|X:3301|37:103983|X:107284|38:207966|X:3301|40:103983|X:107284|42:207966|X:3301|38:103983|X:107284|42:207966|X:3301|47:103983|X:107284|45:207966|X:3301|42:103983|X:107284|38:207966|X:3301|42:103983|X:107284|45:762542|X:82526|47:207966|X:3301|49:103983|X:107284|50:207966|X:3301|52:103983|X:107284|54:207966|X:3301|50:103983|X:107284|54:207966|X:214568|53:207966|X:3301|49:103983|X:107284|53:207966|X:214568|52:207966|X:3301|48:103983|X:107284|52:207966|X:214568|47:207966|X:3301|49:103983|X:107284|50:207966|X:3301|52:103983|X:107284|54:207966|X:3301|50:103983|X:107284|54:207966|X:3301|59:103983|X:107284|54:207966|X:3301|50:103983|X:107284|54:207966|X:3301|59:103983|X:107284|47:762542|X:82526|59:207966|X:3301|61:103983|X:107284|54:103982|X:1650|41:95730|X:9903|64:103983|X:107284|66:207966|X:3301|62:103983|X:107284|54:207965|X:3301|42:103983|X:107284|65:207966|X:3301|61:103983|X:107284|54:207965|X:3301|42:103983|X:107284|64:207966|X:3301|60:103983|X:107284|54:207965|X:3301|42:103983|X:107284|59:207966|X:3301|61:103983|X:107284|54:103982|X:1650|41:95730|X:9903|64:103983|X:107284|66:207966|X:3301|62:103983|X:107284|66:103982|X:1650|41:95730|X:9903|71:103983|X:107284|69:207966|X:3301|66:103983|X:107284|57:103982|X:1650|44:95730|X:9903|66:103983|X:107284|69:762540|X:82526|71:207966|X:3301|73:103983|X:107284|66:103982|X:1650|41:95730|X:9903|76:103983|X:107284|78:207966|X:3301|74:103983|X:107284|66:207965|X:3301|42:103983|X:107284|77:207966|X:3301|73:103983|X:107284|66:207965|X:3301|42:103983|X:107284|76:207966|X:3301|72:103983|X:107284|66:207965|X:3301|42:103983|X:107284|71:207966|X:3301|73:103983|X:107284|66:103982|X:1650|41:95730|X:9903|76:103983|X:107284|78:207966|X:3301|74:103983|X:107284|78:103982|X:1650|41:95730|X:9903|83:103983|X:107284|81:207966|X:3301|78:103983|X:107284|69:103982|X:1650|44:95730|X:9903|78:103983|X:107284|81:762540|X:82526|66:207966|X:3301|68:103983|X:107284|70:381269|X:41263|73:207966|X:3301|70:103983|X:107284|73:381270|X:41263|74:207966|X:3301|70:103983|X:107284|74:381270|X:41263|73:207966|X:3301|70:103983|X:107284|73:381270|X:41263|66:207966|X:3301|68:103983|X:107284|70:381269|X:41263|73:207966|X:3301|70:103983|X:107284|73:381270|X:41263|74:207966|X:3301|70:103983|X:107284|74:381270|X:41263|73:414281|X:8252|66:381270|X:41263|78:207966|X:3301|80:103983|X:107284|82:207964|X:3301|83:103983|X:107284|85:207966|X:3301|82:103983|X:107284|85:207965|X:3301|49:103983|X:107284|86:207966|X:3301|82:103983|X:107284|86:207965|X:3301|50:103983|X:107284|85:207966|X:3301|82:103983|X:107284|85:207965|X:3301|49:103983|X:107284|78:207966|X:3301|80:103983|X:107284|82:207964|X:3301|83:103983|X:107284|85:207966|X:3301|82:103983|X:107284|85:207965|X:3301|49:103983|X:107284|86:207966|X:3301|82:103983|X:107284|86:207965|X:3301|50:103983|X:107284|85:414281|X:8252|78:381270|X:41228|59:124460|X:12931|41:263467|X:12931|54:124460|X:12931|41:263467|X:12931|66:124460|X:12931|41:263467|X:12931|54:261852|X:12931|42:126077|X:12931|65:124460|X:12931|41:263467|X:12931|54:261852|X:12931|42:126077|X:12931|64:124460|X:12931|41:263467|X:12931|54:261852|X:12931|42:126077|X:12931|59:124460|X:12931|41:263467|X:12931|54:124460|X:12931|41:263467|X:12931|66:124460|X:12931|41:263467|X:12931|59:124460|X:12931|41:263467|X:12930|69:124460|X:12931|44:263467|X:12931|57:124460|X:12931|44:263467|X:12931|69:814653|X:12931|71:121937|X:12668|41:258125|X:12668|66:121937|X:12668|41:258125|X:12668|78:121937|X:12668|41:258125|X:12668|66:256544|X:12668|42:123521|X:12668|77:121937|X:12668|41:258125|X:12668|66:256544|X:12668|42:123521|X:12668|76:121937|X:12668|41:258125|X:12668|66:256544|X:12668|42:123521|X:12668|71:120312|X:12500|41:250613|X:12228|66:342383|X:36623|78:328544|X:35159|78:315780|X:33808|78:303971|X:32557|71:293013|X:31395|71:600737|X:30838|83:569895|X:61677|90:569895|X:61677|89:569895|X:61677|88:569895|X:61677|83:569895|X:61677|90:569895|X:61677|93:569895|X:61677|93:569895|X:61677|83:569895|X:61677|90:569895|X:61677|89:569895|X:61677|88:569895|X:61677|83:569895|X:61677|90:569895|X:61677|93:569895|X:61677|93:569895|X:61677|90:569895|X:61677|97:284948|X:30838|97:284948|X:30838|98:155426|X:2467|94:77713|X:80180|98:155426|X:2467|52:77713|X:80180|97:155426|X:2467|94:77713|X:80180|97:284948|X:30838|90:143091|X:14802|92:77713|X:80180|94:77713|X:80180|95:77713|X:80180|97:77713|X:80180|94:77713|X:80180|97:155426|X:2467|49:77713|X:80180|98:77713|X:80180|94:77713|X:80180|98:155426|X:2467|52:77713|X:80180|97:569895|X:61677|90:569895|X:61677|97:284948|X:30838|97:284948|X:30838|99:155426|X:2467|94:77713|X:80180|99:155426|X:2467|53:77713|X:80180|97:155426|X:2467|94:77713|X:80180|97:284948|X:30838|90:143091|X:14802|92:77713|X:80180|94:77713|X:80180|95:77713|X:80180|97:77713|X:80180|94:77713|X:80180|97:155426|X:2467|49:77713|X:80180|99:77713|X:80180|94:77713|X:80180|99:155426|X:2467|53:77713|X:80180|97:569895|X:61677|83:541403|X:58593|90:541403|X:58593|89:541403|X:58593|88:541403|X:58593|83:541403|X:58593|90:541403|X:58593|93:541403|X:58593|93:541403|X:58593|83:132621|X:13719|85:72027|X:74313|86:72027|X:74313|88:72027|X:74313|90:72027|X:74313|86:72027|X:74313|90:144054|X:2286|42:72027|X:74313|89:132621|X:13719|85:132621|X:13719|89:144053|X:2286|42:72027|X:74313|88:132621|X:13719|84:132621|X:13719|88:144053|X:2286|42:72027|X:74313|83:132621|X:13719|85:72027|X:74313|86:72027|X:74313|88:72027|X:74313|90:70312|X:72544|86:70312|X:72544|90:68677|X:70857|95:68677|X:70857|90:67116|X:69247|86:67116|X:69247|90:67116|X:69247|95:67116|X:69247|83:492185|X:53266|35:230766|X:0|86:208232|X:484073|35:230766|X:0|86:208232|X:484074|71:208230|X:22536|74:208230|X:22536|78:208230|X:22536|78:208230|X:22536|82:208230|X:22536|82:208230|X:22536|83:439000|X:22536|35:230766|X:0|86:208232|X:484073|35:230766|X:0|86:208232|X:484074|83:208230|X:22536|86:208230|X:22536|90:208230|X:22536|90:208230|X:22536|94:208230|X:22536|94:208230|X:22536|95:439000|X:22536|35:230766|X:0|86:208232|X:484074|35:230766|X:0|86:208232|X:484074|35:230766|X:0|86:230766|X:0|86:230766|X:0|86:208232|X:22536|92:230765|X:0|86:230766|X:0|86:230766|X:0|86:208232|X:484074|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|35:52283|X:5408|47:52283|X:5408|23:230766|X:0|86:208232|X:0|",
    "X:0|23:106997|X:327783|30:106997|X:327783|23:106997|X:327783|30:213994|X:220787|23:106997|X:327783|30:213994|X:220787|23:106997|X:327783|30:213994|X:220787|23:106997|X:327783|30:106997|X:327783|23:106997|X:327783|30:106997|X:327783|26:106997|X:327783|33:106997|X:327783|26:213994|X:220787|33:213994|X:220787|23:106997|X:327783|30:106997|X:327783|23:106997|X:327783|30:213994|X:220787|23:106997|X:327783|30:213994|X:220787|23:106997|X:327783|30:213994|X:220787|23:106997|X:327783|30:106997|X:327783|23:106997|X:327783|30:106997|X:327783|26:106997|X:327783|33:106997|X:327783|57:784644|X:84918|30:106997|X:327783|37:106997|X:327783|30:106997|X:327783|37:213994|X:220787|26:106997|X:327783|33:213994|X:220787|30:106997|X:327783|37:213994|X:220787|30:106997|X:327783|37:106997|X:327783|30:106997|X:327783|37:213994|X:220787|26:106997|X:327783|33:213994|X:220787|30:213994|X:655567|30:106997|X:327783|37:106997|X:327783|30:106997|X:327783|37:213994|X:220787|26:106997|X:327783|33:213994|X:220787|30:106997|X:327783|37:213994|X:220787|30:106997|X:327783|37:106997|X:327783|30:106997|X:327783|37:213994|X:220787|26:106997|X:327783|33:213994|X:220787|30:213994|X:655567|23:106997|X:318551|30:103983|X:318551|23:103983|X:318551|30:207966|X:214568|23:103983|X:318551|30:207966|X:214568|23:103983|X:318551|30:207966|X:214568|23:103983|X:318551|30:103983|X:318551|23:103983|X:318551|30:103983|X:318551|26:103983|X:318551|33:103983|X:318551|26:207966|X:214568|33:207966|X:214568|23:103983|X:318551|30:103983|X:318551|23:103983|X:318551|30:207966|X:214568|23:103983|X:318551|30:207966|X:214568|23:103983|X:318551|30:207966|X:214568|23:103983|X:318551|35:103983|X:318551|33:103983|X:318551|31:103983|X:318551|30:103983|X:318551|28:103983|X:318551|26:207966|X:214568|25:207966|X:214568|23:103983|X:318551|62:103982|X:107283|42:103983|X:107284|35:103983|X:318551|66:207965|X:214568|35:103983|X:318551|65:207965|X:214568|35:103983|X:318551|64:207965|X:214568|35:103983|X:318551|62:103982|X:107283|42:103983|X:107284|35:103983|X:318551|42:95730|X:115535|42:103983|X:107284|38:103983|X:318551|62:103982|X:107283|45:103983|X:107284|38:207966|X:214568|45:95730|X:9903|44:95730|X:9903|45:103983|X:107283|35:103983|X:318551|74:103982|X:107283|42:103983|X:107284|35:103983|X:318551|78:207965|X:214568|35:103983|X:318551|77:207965|X:214568|35:103983|X:318551|76:207965|X:214568|35:103983|X:318551|74:103982|X:107283|42:103983|X:107284|35:103983|X:318551|42:95730|X:115535|42:103983|X:107284|38:103983|X:318551|74:103982|X:107283|45:103983|X:107284|38:207966|X:214568|45:95730|X:9903|44:95730|X:9903|45:103983|X:107283|42:103983|X:318551|66:103982|X:1650|48:95730|X:9903|71:103983|X:107284|42:103983|X:318551|66:381270|X:41263|38:103983|X:318551|66:381270|X:41263|42:103983|X:318551|66:381270|X:41263|42:103983|X:318551|66:103982|X:1650|48:95730|X:9903|71:103983|X:107284|42:103983|X:318551|66:381270|X:41263|38:103983|X:318551|66:381270|X:41263|42:207966|X:214567|70:381270|X:41263|42:103983|X:318551|78:103982|X:1650|48:95730|X:9903|49:103983|X:107284|42:103983|X:318551|78:207965|X:214568|38:103983|X:318551|78:207965|X:214568|42:103983|X:318551|78:207965|X:214568|42:103983|X:318551|78:103982|X:1650|48:95730|X:9903|49:103983|X:107284|42:103983|X:318551|78:207965|X:214568|38:103983|X:318551|78:207965|X:214568|42:207966|X:214567|82:381270|X:41228|35:101831|X:105064|61:54956|X:12931|42:33943|X:105064|62:101831|X:105064|64:54956|X:12931|42:33943|X:105064|35:101831|X:105064|62:54956|X:12931|42:33943|X:105064|66:203663|X:210128|35:101831|X:105064|61:54956|X:12931|42:33943|X:105064|65:203663|X:210128|35:101831|X:105064|60:54956|X:12931|42:33943|X:105064|64:203663|X:210128|35:101831|X:105064|61:54956|X:12931|42:33943|X:105064|62:101831|X:105064|64:54956|X:12931|42:33943|X:105064|35:101831|X:105064|62:54956|X:12931|42:33943|X:105064|66:101831|X:105064|71:54956|X:12931|42:33943|X:105063|38:101831|X:105064|66:54956|X:12931|45:33943|X:105064|62:101831|X:105064|66:54956|X:12931|45:33943|X:105064|38:124461|X:12931|44:124461|X:12931|45:126077|X:12931|57:373383|X:40409|35:99767|X:102933|73:53842|X:12668|42:33255|X:102933|74:99767|X:102933|76:53842|X:12668|42:33255|X:102933|35:99767|X:102933|74:53842|X:12668|42:33255|X:102933|78:199534|X:205867|35:99767|X:102933|73:53842|X:12668|42:33255|X:102933|77:199534|X:205867|35:99767|X:102933|72:53842|X:12668|42:33255|X:102933|76:199534|X:205867|35:98437|X:101562|73:51971|X:12228|42:32099|X:99356|74:342383|X:36623|45:328544|X:35159|43:315780|X:33808|42:303971|X:32557|74:293013|X:31395|38:284950|X:30838|37:284949|X:30838|83:77713|X:80180|85:77713|X:80180|86:77713|X:80180|88:77713|X:80180|83:77713|X:80180|86:77713|X:80180|90:155426|X:2467|42:77713|X:80180|83:77713|X:80180|85:77713|X:80180|89:155426|X:2467|42:77713|X:80180|83:77713|X:80180|84:77713|X:80180|88:155426|X:2467|42:77713|X:80180|83:77713|X:80180|85:77713|X:80180|86:77713|X:80180|88:77713|X:80180|83:77713|X:80180|86:77713|X:80180|90:77713|X:80180|95:77713|X:80180|81:569895|X:61677|81:569895|X:61677|83:77713|X:80180|85:77713|X:80180|86:77713|X:80180|88:77713|X:80180|83:77713|X:80180|86:77713|X:80180|90:155426|X:2467|42:77713|X:80180|83:77713|X:80180|85:77713|X:80180|89:155426|X:2467|42:77713|X:80180|83:77713|X:80180|84:77713|X:80180|88:155426|X:2467|42:77713|X:80180|83:77713|X:80180|85:77713|X:80180|86:77713|X:80180|88:77713|X:80180|83:77713|X:80180|86:77713|X:80180|90:77713|X:80180|95:77713|X:80180|81:569895|X:61677|81:569895|X:61677|90:77713|X:80180|92:77713|X:80180|94:77713|X:80180|95:77713|X:80180|85:284948|X:30838|85:284948|X:30838|86:155426|X:2467|49:77713|X:80180|90:155426|X:160360|85:155426|X:2467|52:77713|X:80180|85:284948|X:30838|90:77713|X:80180|90:77713|X:80180|90:77713|X:80180|90:77713|X:80180|85:77713|X:80180|85:77713|X:80180|85:155426|X:160360|86:77713|X:80180|86:77713|X:80180|86:155426|X:160360|85:569895|X:61677|90:77713|X:80180|92:77713|X:80180|94:77713|X:80180|95:77713|X:80180|85:284948|X:30838|85:284948|X:30838|87:155426|X:2467|49:77713|X:80180|90:155426|X:160360|85:155426|X:2467|53:77713|X:80180|85:284948|X:30838|90:77713|X:80180|90:77713|X:80180|90:77713|X:80180|90:77713|X:80180|85:77713|X:80180|85:77713|X:80180|85:155426|X:160360|87:77713|X:80180|87:77713|X:80180|87:155426|X:160360|85:569895|X:61677|83:73828|X:76171|85:73828|X:76171|86:73828|X:76171|88:73828|X:76171|83:73828|X:76171|86:73828|X:76171|90:147656|X:2343|42:73828|X:76171|83:73828|X:76171|85:73828|X:76171|89:147656|X:2343|42:73828|X:76171|83:73828|X:76171|84:73828|X:76171|88:147656|X:2343|42:73828|X:76171|83:73828|X:76171|85:73828|X:76171|86:73828|X:76171|88:73828|X:76171|83:73828|X:76171|86:73828|X:76171|90:73828|X:76171|95:73828|X:76171|81:541403|X:58593|81:541403|X:58593|83:72027|X:74313|83:72027|X:74313|83:72027|X:74313|83:72027|X:74313|83:72027|X:74313|83:72027|X:74313|83:144054|X:148626|83:72027|X:74313|83:72027|X:74313|83:132621|X:160058|83:72027|X:74313|83:72027|X:74313|83:132621|X:160058|83:72027|X:74313|83:72027|X:74313|83:72027|X:74313|83:72027|X:74313|83:70312|X:72544|83:70312|X:72544|83:68677|X:70857|83:68677|X:70857|83:67116|X:69247|45:67116|X:69247|43:67116|X:69247|42:67116|X:69247|35:67116|X:69247|45:67116|X:69247|43:67116|X:69247|42:67116|X:69246|47:208230|X:22536|95:208232|X:484073|47:208230|X:22536|95:208232|X:484074|43:208230|X:22536|50:208230|X:22536|42:208230|X:22536|50:208230|X:22536|30:208230|X:22536|49:208230|X:22536|35:208232|X:22536|50:208232|X:22536|47:208230|X:22536|95:208232|X:484073|47:208230|X:22536|95:208232|X:484074|43:208230|X:22536|50:208230|X:22536|42:208230|X:22536|50:208230|X:22536|30:208230|X:22536|49:208230|X:22536|35:208232|X:22536|50:208232|X:22536|47:208230|X:22536|95:208232|X:484074|47:208230|X:22536|95:208232|X:484074|47:208230|X:22536|95:208230|X:22536|95:208230|X:22536|95:208232|X:22536|50:120791|X:0|93:30649|X:0|86:56789|X:22536|95:208230|X:22536|95:208230|X:22536|95:208232|X:1868658|35:208230|X:22536|95:208232|X:0|",
    "X:13043408|26:213994|X:220787|33:213994|X:28080395|42:95730|X:749336|42:95730|X:9903|41:95730|X:643704|42:95730|X:9903|41:95730|X:643704|42:95730|X:9903|41:95730|X:643704|42:95730|X:749336|50:95730|X:749336|45:95730|X:749336|54:95730|X:749336|42:95730|X:749336|42:95730|X:9903|41:95730|X:643704|42:95730|X:9903|41:95730|X:643704|42:95730|X:9903|41:95730|X:643704|42:95730|X:749336|50:95730|X:749336|45:95730|X:749336|54:95730|X:749336|49:95730|X:115535|49:103983|X:529818|70:207965|X:3301|49:103983|X:529818|70:207965|X:3301|50:103983|X:529818|70:207965|X:3301|49:103983|X:529818|49:95730|X:115535|49:103983|X:529818|70:207965|X:3301|49:103983|X:529818|70:207965|X:3301|50:103983|X:529817|49:95730|X:9903|48:95730|X:9903|49:103983|X:529818|49:95730|X:749336|82:207965|X:637102|82:207965|X:637102|82:207965|X:637102|49:95730|X:749336|82:207965|X:637102|82:207965|X:637101|49:95730|X:9903|48:95730|X:9903|49:103983|X:521038|50:101831|X:725747|50:124461|X:12931|41:66271|X:623917|49:124461|X:12931|41:66271|X:623917|48:124461|X:12931|41:66271|X:623917|50:101831|X:725747|50:101831|X:725746|54:101831|X:725750|62:373383|X:445807|50:99767|X:711029|50:121938|X:12668|41:64928|X:611265|49:121938|X:12668|41:64928|X:611265|48:121938|X:12668|41:64928|X:601520|47:94252|X:97244|76:92290|X:95220|47:328544|X:35159|47:315780|X:33808|47:303971|X:32557|78:293013|X:31395|47:284950|X:30838|47:284949|X:30838|35:77713|X:80180|45:77713|X:80180|43:77713|X:80180|42:77713|X:80180|35:77713|X:80180|45:77713|X:80180|43:77713|X:238073|35:77713|X:80180|45:77713|X:80180|43:77713|X:238073|35:77713|X:80180|45:77713|X:80180|43:77713|X:238073|35:77713|X:80180|45:77713|X:80180|43:77713|X:80180|42:77713|X:80180|35:77713|X:80180|45:77713|X:80180|43:77713|X:80180|42:77713|X:80180|86:77713|X:80180|90:77713|X:80180|86:77713|X:80180|90:77713|X:80180|86:569895|X:61677|35:77713|X:80180|45:77713|X:80180|43:77713|X:80180|42:77713|X:80180|35:77713|X:80180|45:77713|X:80180|43:77713|X:238073|35:77713|X:80180|45:77713|X:80180|43:77713|X:238073|35:77713|X:80180|45:77713|X:80180|43:77713|X:238073|35:77713|X:80180|45:77713|X:80180|43:77713|X:80180|42:77713|X:80180|35:77713|X:80180|45:77713|X:80180|43:77713|X:80180|42:77713|X:80180|86:77713|X:80180|90:77713|X:80180|81:77713|X:80180|90:77713|X:80180|86:569895|X:61677|42:77713|X:80180|52:77713|X:80180|50:77713|X:80180|49:77713|X:80180|90:77713|X:80180|94:77713|X:80180|90:155426|X:2467|49:77713|X:80180|90:77713|X:238073|94:155426|X:160360|90:77713|X:238073|90:155426|X:2467|49:77713|X:80180|42:77713|X:80180|52:77713|X:80180|50:77713|X:80180|49:77713|X:80180|90:77713|X:80180|90:77713|X:80180|90:155426|X:160360|90:77713|X:80180|90:77713|X:80180|90:155426|X:160360|90:309619|X:6167|50:77713|X:80180|49:77713|X:80180|42:77713|X:80180|53:77713|X:80180|51:77713|X:80180|49:77713|X:80180|90:77713|X:80180|94:77713|X:80180|90:155426|X:2467|49:77713|X:80180|90:77713|X:238073|94:155426|X:160360|90:77713|X:238073|90:155426|X:2467|49:77713|X:80180|42:77713|X:80180|53:77713|X:80180|51:77713|X:80180|49:77713|X:80180|90:77713|X:80180|90:77713|X:80180|90:155426|X:160360|90:77713|X:80180|90:77713|X:80180|90:155426|X:160360|90:309619|X:6167|51:77713|X:80180|49:77713|X:80180|35:73828|X:76171|45:73828|X:76171|43:73828|X:76171|42:73828|X:76171|35:73828|X:76171|45:73828|X:76171|43:73828|X:226170|35:73828|X:76171|45:73828|X:76171|43:73828|X:226170|35:73828|X:76171|45:73828|X:76171|43:73828|X:226170|35:73828|X:76171|45:73828|X:76171|43:73828|X:76171|42:73828|X:76171|35:73828|X:76171|45:73828|X:76171|43:73828|X:76171|42:73828|X:76171|86:73828|X:76171|90:73828|X:76171|86:73828|X:76171|90:73828|X:76171|86:541403|X:58593|35:72027|X:74313|45:72027|X:74313|43:72027|X:74313|42:72027|X:74313|35:72027|X:74313|45:72027|X:74313|43:72027|X:220653|35:72027|X:74313|45:72027|X:74313|43:72027|X:220652|35:72027|X:74313|45:72027|X:74313|43:72027|X:220652|35:72027|X:74313|45:72027|X:74313|43:72027|X:74313|42:72027|X:74313|35:70312|X:72544|45:70312|X:72544|43:68677|X:70857|42:68677|X:70857|35:67116|X:478336|47:67116|X:557661|92:41466|X:0|93:69410|X:0|94:18028|X:22536|50:113581|X:658050|92:41466|X:0|93:69410|X:0|94:18028|X:22536|50:113581|X:578725|55:56790|X:58593|73:56790|X:58593|55:208230|X:22536|54:56790|X:58593|74:56790|X:58593|54:208230|X:22536|42:56790|X:58593|78:56790|X:58593|54:208230|X:22536|47:208232|X:22536|54:208232|X:101862|92:41466|X:0|93:69410|X:0|94:18028|X:22536|50:113581|X:658050|92:41466|X:0|93:69410|X:0|94:18028|X:22536|50:113581|X:578725|55:56790|X:58593|85:56790|X:58593|55:208230|X:22536|54:56790|X:58593|86:56790|X:58593|54:208230|X:22536|42:56790|X:58593|90:56790|X:58593|54:208230|X:22536|47:208232|X:22536|54:208232|X:101862|92:41466|X:0|93:69410|X:0|94:18028|X:22536|50:208232|X:563400|92:41466|X:0|93:69410|X:0|94:18028|X:22536|50:113581|X:658051|92:41466|X:0|93:69410|X:0|94:18028|X:22536|50:120792|X:0|93:69410|X:0|94:18028|X:22536|50:120792|X:0|93:69410|X:0|94:18028|X:22536|50:113581|X:117187|53:113580|X:37860|95:38761|X:0|94:18028|X:22536|50:120792|X:0|93:69410|X:0|94:18028|X:22536|50:120792|X:0|93:69410|X:0|94:18028|X:22536|50:113581|X:2042635|92:41466|X:0|93:69410|X:0|94:18028|X:22536|47:113581|X:0|"
  };
  Song odeAnDieFreude = {
    "T:120 K:C F#3/2 G3/4 A3/2 G3/4 F#3/4 E3/4 D3/2 E3/4 F#3/2 E3/4. R/4 F#3/2 G3/4 A3/2 G3/4 F#3/4 E3/4 D3/2 E3/4 F#3/4 E3/4. D3/4. R/4 E3/2 F#3/4 D3/4 E3/4 F#3/8 G3/8 R/64 F#3/4 D3/4 E3/4 F#3/8 G3/8 R/64 F#3/4 E3/4 D3/4 E3/4 A2/4 F#3/2. G3/4 A3/2 G3/4 F#3/4 E3/4 D3/2 E3/4 F#3/4 E3/4. D3/4. R/4 E3/2 F#3/4 D3/4 E3/4 F#3/8 G3/8 R/64 F#3/4 D3/4 E3/4 F#3/8 G3/8 R/64 F#3/4 E3/4 D3/4 E3/4 A2/4 F#3/2. G3/4 A3/2 G3/4 F#3/4 E3/4 D3/2 E3/4 F#3/4 E3/4. D3/4."
  };
  Song tetrisB = {
    "X:0|64:195689|X:11206|64:97413|X:6034|64:97413|X:6034|59:195689|X:11206|59:195689|X:11206|64:196330|X:11284|64:98090|X:6076|64:98776|X:6118|59:198426|X:11363|59:199823|X:11443|64:195689|X:11206|64:97413|X:6034|64:97413|X:6034|59:195689|X:11206|59:195689|X:11206|64:196330|X:11284|64:98090|X:6076|64:98776|X:6118|59:198426|X:11363|59:199823|X:11443|59:195689|X:11206|67:195689|X:11206|67:195689|X:11206|69:195689|X:11206|67:196330|X:11284|66:98090|X:6076|67:98776|X:6118|69:198426|X:11363|66:199823|X:11443|67:195689|X:11206|63:97413|X:6034|64:97413|X:6034|66:195689|X:11206|63:195689|X:11206|64:196330|X:11284|58:98090|X:6076|59:98776|X:6118|63:198426|X:11363|59:199823|X:11443|59:195689|X:11206|55:195689|X:11206|57:195689|X:11206|57:195689|X:11206|59:196330|X:11284|55:197697|X:11363|57:198426|X:11363|63:199823|X:11443|59:206034|X:1039693|59:200491|X:11524|59:203365|X:11690|59:210499|X:1035344|62:206034|X:207758|67:195689|X:11206|67:97413|X:6034|67:97413|X:6034|69:195689|X:11206|66:195689|X:11206|67:196330|X:11284|67:98090|X:6076|67:98776|X:6118|69:198426|X:11363|66:199823|X:11443|67:206034|X:1038227|66:208915|X:212141|67:195689|X:11206|67:97413|X:6034|67:97413|X:6034|69:195689|X:11206|66:195689|X:11206|67:196330|X:11284|67:98090|X:6076|67:98776|X:6118|69:198426|X:11363|66:199823|X:11443|62:206034|X:1039693|64:211129|X:215941|66:200154|X:11206|67:97413|X:6034|69:97413|X:6034|66:195689|X:11206|69:195689|X:11206|71:195689|X:11206|71:195689|X:11206|71:195689|X:11206|64:195689|X:11206|66:195689|X:11206|67:97413|X:6034|69:97413|X:6034|66:195689|X:11206|69:195689|X:11206|70:195689|X:11206|70:195689|X:11206|70:195689|X:11206|64:195689|X:11206|66:195689|X:11206|67:97413|X:6034|69:97413|X:6034|66:195689|X:11206|69:195689|X:11206|64:195689|X:11206|66:97413|X:6034|67:97413|X:6034|64:195689|X:11206|67:195689|X:11206|64:195689|X:11206|66:97413|X:6034|67:97413|X:6034|66:195689|X:11206|66:195689|X:11206|57:195689|X:11206|64:195689|X:11206|66:195689|X:11206|57:195689|X:11206|59:195689|X:11206|59:97413|X:6034|59:97413|X:6034|59:195689|X:11206|59:195689|X:218103|59:97413|X:6034|61:97413|X:6034|59:195689|X:11206|55:195689|X:11206|58:195689|X:11206|58:97413|X:6034|58:97413|X:6034|58:195689|X:11206|58:195689|X:218103|58:97413|X:6034|60:97413|X:6034|58:195689|X:11206|55:195689|X:11206|54:206034|X:2690516|57:206034|X:0|",
    "X:3330616|64:195689|X:11206|71:195689|X:11206|76:195689|X:11206|75:195689|X:11206|76:196330|X:11284|71:98090|X:6076|71:98776|X:6118|72:198426|X:11363|69:199823|X:11443|71:195689|X:11206|66:97413|X:6034|67:97413|X:6034|69:195689|X:11206|66:195689|X:11206|67:196330|X:11284|64:98090|X:6076|64:98776|X:6118|66:198426|X:11363|63:199823|X:11443|64:195689|X:11206|59:195689|X:11206|60:195689|X:11206|63:195689|X:11206|64:196330|X:11284|59:197697|X:11363|60:198426|X:11363|66:199823|X:11443|64:206034|X:1039693|66:200491|X:11524|63:203365|X:11690|64:210499|X:1035344|66:206034|X:3117327|69:208915|X:212141|71:195689|X:11206|71:97413|X:6034|71:97413|X:6034|72:195689|X:11206|69:195689|X:11206|71:196330|X:11284|71:98090|X:6076|71:98776|X:6118|72:198426|X:11363|69:199823|X:11443|71:206034|X:1039693|73:211129|X:215941|74:200154|X:11206|74:97413|X:6034|74:97413|X:6034|74:195689|X:11206|74:195689|X:11206|76:195689|X:11206|74:195689|X:11206|74:195689|X:11206|73:195689|X:11206|74:195689|X:11206|74:97413|X:6034|74:97413|X:6034|74:195689|X:11206|74:195689|X:11206|76:195689|X:11206|74:195689|X:11206|74:195689|X:11206|73:195689|X:11206|74:195689|X:11206|74:97413|X:6034|74:97413|X:6034|74:195689|X:11206|74:195689|X:11206|73:195689|X:11206|73:97413|X:6034|73:97413|X:6034|73:195689|X:11206|73:195689|X:11206|72:195689|X:11206|72:97413|X:6034|72:97413|X:6034|72:195689|X:11206|69:195689|X:11206|66:195689|X:11206|67:195689|X:11206|69:195689|X:11206|62:195689|X:11206|69:195689|X:11206|67:97413|X:6034|67:97413|X:6034|62:195689|X:11206|67:195689|X:218103|62:97413|X:6034|64:97413|X:6034|62:195689|X:11206|59:195689|X:11206|69:195689|X:11206|67:97413|X:6034|67:97413|X:6034|62:195689|X:11206|67:195689|X:218103|62:97413|X:6034|64:97413|X:6034|62:195689|X:11206|58:195689|X:11206|62:206034|X:2690516|63:206034|X:0|",
    "X:0|40:206034|X:862|40:102586|X:862|40:102586|X:862|35:206034|X:862|35:206034|X:862|40:206034|X:868|40:103298|X:868|40:103298|X:874|35:208915|X:874|35:208915|X:880|40:210387|X:862|40:102586|X:862|40:102586|X:862|35:206034|X:862|35:206034|X:862|40:206034|X:868|40:103298|X:868|40:104020|X:874|35:208915|X:874|35:210387|X:880|40:206034|X:862|40:102586|X:862|40:102586|X:862|35:206034|X:862|35:206034|X:862|40:206034|X:868|40:103298|X:868|40:104020|X:874|35:208915|X:874|35:210387|X:880|40:206034|X:862|40:102586|X:862|40:102586|X:862|35:206034|X:862|35:206034|X:862|40:206034|X:868|40:103298|X:868|40:103298|X:874|35:208915|X:874|35:208915|X:880|40:210387|X:862|40:102586|X:862|40:102586|X:862|35:206034|X:862|35:206034|X:862|40:206034|X:868|40:103298|X:868|40:104020|X:874|35:208915|X:874|35:210387|X:880|40:206034|X:862|40:102586|X:862|40:102586|X:862|36:206034|X:862|33:206034|X:862|40:206034|X:868|40:104020|X:874|40:104753|X:880|39:210387|X:886|35:211879|X:899|40:214928|X:862|40:102586|X:862|40:102586|X:862|36:206034|X:862|33:206034|X:862|40:206034|X:862|40:102586|X:862|40:102586|X:862|38:206034|X:862|26:206034|X:862|43:206034|X:862|55:102586|X:862|50:102586|X:862|38:206034|X:862|50:206034|X:862|43:206034|X:868|55:103298|X:868|50:104020|X:874|38:208915|X:874|50:210387|X:880|43:206034|X:862|55:102586|X:862|50:102586|X:862|38:206034|X:862|50:206034|X:862|43:206034|X:868|55:103298|X:868|50:104020|X:874|38:208915|X:874|50:210387|X:880|43:206034|X:862|55:102586|X:862|50:102586|X:862|38:206034|X:862|50:206034|X:862|43:206034|X:868|55:103298|X:868|50:103298|X:874|38:208915|X:874|50:208915|X:880|43:210387|X:862|55:102586|X:862|50:102586|X:862|38:206034|X:862|50:206034|X:862|43:206034|X:868|55:104020|X:874|50:104753|X:880|45:210387|X:886|57:213392|X:899|38:214928|X:862|50:102586|X:862|38:102586|X:862|38:206034|X:862|50:206034|X:862|43:206034|X:862|55:102586|X:862|43:102586|X:862|43:206034|X:862|55:206034|X:862|38:206034|X:862|50:102586|X:862|38:102586|X:862|38:206034|X:862|50:206034|X:862|43:206034|X:862|55:102586|X:862|43:102586|X:862|43:206034|X:862|55:206034|X:862|38:206034|X:862|50:102586|X:862|38:102586|X:862|38:206034|X:862|50:206034|X:862|38:206034|X:862|50:102586|X:862|38:102586|X:862|38:206034|X:862|50:206034|X:862|38:206034|X:862|50:102586|X:862|38:102586|X:862|38:206034|X:862|50:206034|X:862|38:206034|X:862|50:102586|X:862|38:102586|X:862|38:206034|X:862|54:206034|X:862|40:206034|X:862|40:102586|X:862|40:102586|X:862|40:206034|X:862|40:206034|X:862|40:206034|X:862|40:102586|X:862|40:102586|X:862|40:206034|X:862|40:206034|X:862|39:206034|X:862|39:102586|X:862|39:102586|X:862|39:206034|X:862|39:206034|X:862|39:206034|X:862|39:102586|X:862|39:102586|X:862|39:206034|X:862|39:206034|X:862|38:206034|X:862|50:102586|X:862|38:102586|X:862|38:206034|X:862|50:206034|X:862|38:206034|X:862|50:102586|X:862|38:102586|X:862|38:206034|X:862|50:206034|X:862|38:206034|X:862|50:102586|X:862|38:102586|X:862|38:206034|X:862|50:206034|X:862|38:206034|X:862|50:102586|X:862|38:102586|X:862|39:206034|X:862|51:206034|X:0|"
  };
  std::array<std::unique_ptr<Player>, BUZZER_PINS.size()> players;

  void play(const Song& song) {
    const auto now = Player::now();
    for(int i = 0; i < BUZZER_PINS.size() && i < song.size(); ++i) {
      players[i] = std::make_unique<Player>(song[i], i, now);
    }
  }

} // namespace

void MusicState::enter() {
  play(tetrisB);
}

void MusicState::update() {
  for(auto &player : players) {
    if(player) {
      player->loop();
    }
  }
}

void MusicState::exit() {
  for(auto &player : players) {
    player.reset();
  }
  for (int i = 0; i < BUZZER_PINS.size(); ++i) {
    Buzzer::off(i);
  }
  Pixels::clear();
}
